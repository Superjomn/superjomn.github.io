<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Triton on Superjomn's blog</title><link>/tags/triton/</link><description>Recent content in Triton on Superjomn's blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 15 Nov 2022 00:00:00 +0000</lastBuildDate><atom:link href="/tags/triton/index.xml" rel="self" type="application/rss+xml"/><item><title>OpenAI/Triton MLIR 迁移工作简介</title><link>/posts/triton-mlir-publish/</link><pubDate>Tue, 15 Nov 2022 00:00:00 +0000</pubDate><guid>/posts/triton-mlir-publish/</guid><description>&lt;p&gt;经过几个月的不懈努力，OpenAI Triton已经成功完成了面向MLIR Infra的迁移/重构工作，并将其最新的基于MLIR的代码合并至主分支。这个工作是由OpenAI和NVIDIA相关团队近几个月来深入合作完成的，而我也有幸参与其中。在这篇文章中，我将分享一些技术总结，记录一些收获和思考。&lt;/p&gt;
&lt;p&gt;尽管Triton目前的开源开发非常迅速，但本文将主要聚焦于基于MLIR Infra进行重构的第一个版本的&lt;a href="https://github.com/openai/triton/tree/ca05ef8e5b0b4d4834957bc31e7581b09d35c530"&gt;代码&lt;/a&gt;（这应该也是两三个月前的）&lt;/p&gt;
&lt;h2 id="triton-简介"&gt;Triton 简介&lt;/h2&gt;
&lt;p&gt;OpenAI Triton &lt;a href="https://www.eecs.harvard.edu/~htk/publication/2019-mapl-tillet-kung-cox.pdf"&gt;paper&lt;/a&gt; 中的介绍是 &amp;ldquo;An Intermediate Language and Compiler for Tiled Neural Network Computations&amp;rdquo;，其中几个关键词应该能够代表其特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Intermediate Language&lt;/em&gt;, 目前是基于 Python 的 DSL&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Compiler&lt;/em&gt; ，是一个经典的 Compiler 的架构&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Tiled&lt;/em&gt; Computation，面向 GPU 体系特点，自动分析和实施 tiling&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="定位"&gt;定位&lt;/h3&gt;
&lt;p&gt;由于 Triton 的开发非常迅速，这里只讨论当前 Triton 的功能。&lt;/p&gt;
&lt;p&gt;简而言之，Triton 提供了一套针对 GPU Kernel 的开发的 Language（基于 Python） 和 高性能 Compiler。&lt;/p&gt;
&lt;figure&gt;&lt;img src="/static/triton-publish/1.png"&gt;
&lt;/figure&gt;
&lt;p&gt;因此，就层次而言，Triton的 DNN 开发能力与 CUDA 的部分相对应，但与TVM、XLA等直接面向 DL 的 Domain compiler 无法完全对应。
后者更像是面向 DL 的武器库，拥有从构图到 auto fusion 等端到端的能力，而Triton则更像一把小巧、实用的瑞士军刀，面向偏底层的也是最通用的 Kernel 开发问题。&lt;/p&gt;
&lt;h3 id="新代码中的架构"&gt;新代码中的架构&lt;/h3&gt;
&lt;p&gt;Triton 新代码中的架构总体上可以如下呈现&lt;/p&gt;
&lt;figure&gt;&lt;img src="/static/triton-publish/three-components.png"&gt;
&lt;/figure&gt;
&lt;p&gt;即总体上可以分为三大块&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Frontend，将用户的 Python kernel code 转换为 Triton IR，以及维护 kernel launch 的 Runtime&lt;/li&gt;
&lt;li&gt;Optimizer，通过各类 pass 将 Triton IR 逐步转换为优化过的 TritonGPU IR&lt;/li&gt;
&lt;li&gt;Backend，将 TritonGPU IR 逐步转换为 LLVM IR，并最终通过 ptxas 编译为 cubin&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;贯穿这三部分的核心表示是 Triton 的 IR，微观上，IR 也分为两个层次&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Triton Dialect，表示计算逻辑，硬件无关的表达&lt;/li&gt;
&lt;li&gt;TritonGPU Dialect，GPU 相关的计算表示&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这两者都是基于 MLIR 的自定义 dialect，除此之外，Triton 也复用了很多社区的 dialect 来进行宏观的表示，包括&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;std&lt;/code&gt; dialect： tensor, int, float 等数据类型&lt;/li&gt;
&lt;li&gt;&lt;code&gt;arith&lt;/code&gt; dialect：各类数学操作&lt;/li&gt;
&lt;li&gt;&lt;code&gt;scf&lt;/code&gt; dialect：if, for 等控制流&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nvvm&lt;/code&gt; dialect：获取 &lt;code&gt;thread_id&lt;/code&gt; 等少量操作&lt;/li&gt;
&lt;li&gt;&lt;code&gt;gpu&lt;/code&gt; dialect：printf 等少量操作&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下图是 Triton 中核心表示完整的转换过程：&lt;/p&gt;
&lt;figure&gt;&lt;img src="/static/2023-01-29_15-59-49_screenshot.png"&gt;
&lt;/figure&gt;
&lt;p&gt;其中蓝色的两部分主要是 MLIR 体系涉及的部分，随后 MLIR 会转换为 LLVM IR，之后 Triton 会调用 NVPTX 转换为 PTX Assembly，随后由 CUDA 的 ptxas 编译器编译为 cubin。&lt;/p&gt;
&lt;h2 id="python-界面之-frontend"&gt;Python 界面之 Frontend&lt;/h2&gt;
&lt;p&gt;Frontend 用于将用户用 Python 编写的 kernel 转换为对应的 Triton IR (Triton Dialect)，这里由于篇幅不便展开，细节可以阅读 &lt;a href="https://github.com/openai/triton/blob/ca05ef8e5b0b4d4834957bc31e7581b09d35c530/python/triton/compiler.py#L108"&gt;compiler.py::CodeGenerator&lt;/a&gt; 中基于 Python ast 的规则。&lt;/p&gt;
&lt;p&gt;比如 vector add 的例子&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#555;font-weight:bold"&gt;@triton.jit&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;def&lt;/span&gt; &lt;span style="color:#06287e"&gt;add_kernel&lt;/span&gt;(x_ptr, y_ptr, output_ptr, N,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; BLOCK_SIZE: tl&lt;span style="color:#666"&gt;.&lt;/span&gt;constexpr):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; pid &lt;span style="color:#666"&gt;=&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;program_id(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; block_start &lt;span style="color:#666"&gt;=&lt;/span&gt; pid &lt;span style="color:#666"&gt;*&lt;/span&gt; BLOCK_SIZE
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; offsets &lt;span style="color:#666"&gt;=&lt;/span&gt; block_start &lt;span style="color:#666"&gt;+&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;arange(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, BLOCK_SIZE)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; mask &lt;span style="color:#666"&gt;=&lt;/span&gt; offsets &lt;span style="color:#666"&gt;&amp;lt;&lt;/span&gt; N
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; x &lt;span style="color:#666"&gt;=&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;load(x_ptr &lt;span style="color:#666"&gt;+&lt;/span&gt; offsets, mask&lt;span style="color:#666"&gt;=&lt;/span&gt;mask)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; y &lt;span style="color:#666"&gt;=&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;load(y_ptr &lt;span style="color:#666"&gt;+&lt;/span&gt; offsets, mask&lt;span style="color:#666"&gt;=&lt;/span&gt;mask)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; output &lt;span style="color:#666"&gt;=&lt;/span&gt; x &lt;span style="color:#666"&gt;+&lt;/span&gt; y
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;store(output_ptr&lt;span style="color:#666"&gt;+&lt;/span&gt;offsets, output, mask&lt;span style="color:#666"&gt;=&lt;/span&gt;mask)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;# x, y are torch.Tensor&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;grid &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;lambda&lt;/span&gt; meta: (triton&lt;span style="color:#666"&gt;.&lt;/span&gt;cdiv(n_elements, meta[&lt;span style="color:#4070a0"&gt;&amp;#39;BLOCK_SIZE&amp;#39;&lt;/span&gt;]),)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add_kernel[grid](x, y, output, n_elements, BLOCK_SIZE&lt;span style="color:#666"&gt;=&lt;/span&gt;&lt;span style="color:#40a070"&gt;1024&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;相应会得到 Triton IR&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;fun&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style=""&gt;publi&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@kernel_0d1d2d3d&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;},
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c256_i32&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;256&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;get_program_id&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c256_i32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;256&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;cmpi&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;slt&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addf&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;store&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;256&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;可以看到，Triton IR 几乎一比一地对应到原始的 Python code，将用户定义的 computation 带入 MLIR 的体系，后续会在此基础上做各类优化（by Optimizer）以及最终 translate 到更低层次的表示中（by Backend）。&lt;/p&gt;
&lt;h2 id="性能优化之-optimizer"&gt;性能优化之 Optimizer&lt;/h2&gt;
&lt;p&gt;Optimizer 用于分析和优化 Frontend 传入的 IR，通过各类 Transformation 和 Conversion (Pass) 策略，最终传递给 Backend 做 translate。&lt;/p&gt;
&lt;p&gt;Optimizer 大致的 workflow 如下&lt;/p&gt;
&lt;figure&gt;&lt;img src="/static/triton-publish/optimizer.png"&gt;
&lt;/figure&gt;
&lt;p&gt;主要分为三大块优化&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;TritonIR 的优化&lt;/li&gt;
&lt;li&gt;TritonIR to TritonGPU IR 的 Conversion&lt;/li&gt;
&lt;li&gt;TritonGPU IR 的优化&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;贯穿中间的数据结构是 TritonGPU IR，顾名思义是带上了 GPU 相关的信息的 IR。&lt;/p&gt;
&lt;h3 id="tritongpu-dialect"&gt;TritonGPU Dialect&lt;/h3&gt;
&lt;p&gt;TritonGPU Dialect 相比 Triton Dialect，主要是增加了 GPU 硬件相关的 Op 和 Type。&lt;/p&gt;
&lt;p&gt;相关的主要 Op 如下&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;async_wait(N:int) -&amp;gt; ()&lt;/code&gt;, 直接对应到 PTX 中的 &lt;code&gt;cp.async.wait_group N&lt;/code&gt; 指令&lt;/li&gt;
&lt;li&gt;&lt;code&gt;alloc_tensor()-&amp;gt;Tensor&lt;/code&gt; , 表明 allocate 一个处于 shared memory 的 tensor&lt;/li&gt;
&lt;li&gt;&lt;code&gt;insert_slice_async(slice:PtrTensor, dst:Tensor, index:int, mask:i1 ...) -&amp;gt; Tensor&lt;/code&gt;, 表明往 （alloc_tensor op 产生的，shared memory中的) tensor 中 insert 一个 slice，并且这个操作是 async 的&lt;/li&gt;
&lt;li&gt;&lt;code&gt;convert_layout(src:Tensor)-&amp;gt;Tensor&lt;/code&gt; ，转换 Tensor 中的 data layout&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;前三个 Op 主要在 Pipeline 和 Prefetch 的优化（下文 Pass 中会涉及）中用到， &lt;code&gt;convert_layout&lt;/code&gt; Op 在 TritonGPU Dialect 中的 Type system 比较关键，以下两个小节会重点详解。&lt;/p&gt;
&lt;h4 id="data-layout"&gt;Data layout&lt;/h4&gt;
&lt;p&gt;Data layout 是 TritonGPU Dialect 的 Type system 的关键，确定了 Data(各层级memory中的Tensor) 到 thread 之间的映射关系。&lt;/p&gt;
&lt;p&gt;目前 Triton 中有如下几种&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;Blocked Layout&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Blocked Layout 表示 thread 间平均分配 workload 的情况，每个线程 own 一块 memory 上连续的 data 进行处理。&lt;/p&gt;
&lt;p&gt;其包含了如下三个字段用于帮助确定 thread 和数据之间的映射关系：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;sizePerThread：每个 thread 处理的 &lt;strong&gt;连续排布&lt;/strong&gt; 的元素数目&lt;/li&gt;
&lt;li&gt;threadsPerWarp：每个 Warp 在不同维度上的线程数，用向量表示&lt;/li&gt;
&lt;li&gt;warpsPerCTA：每个 CTA 对应的 Warp 数目，这个由用户在 Python 层制定&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;按代码中的例子&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-nil" data-lang="nil"&gt;For example, a row-major coalesced layout may partition a 16x16 tensor over 2 warps (i.e. 64 threads) as follows.
[ 0 0 1 1 2 2 3 3 ; 32 32 33 33 34 34 35 35 ]
[ 0 0 1 1 2 2 3 3 ; 32 32 33 33 34 34 35 35 ]
[ 4 4 5 5 6 6 7 7 ; 36 36 37 37 38 38 39 39 ]
[ 4 4 5 5 6 6 7 7 ; 36 36 37 37 38 38 39 39 ]
...
[ 28 28 29 29 30 30 31 31 ; 60 60 61 61 62 62 63 63 ]
[ 28 28 29 29 30 30 31 31 ; 60 60 61 61 62 62 63 63 ]
for
#triton_gpu.blocked_layout&amp;lt;{
sizePerThread = {2, 2}
threadsPerWarp = {8, 4}
warpsPerCTA = {1, 2}
}&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start="2"&gt;
&lt;li&gt;Shared Layout&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Shared Layout：表示数据在 shared memory 的一些特性，比如 swizzle 访问的一些参数。&lt;/p&gt;
&lt;p&gt;其包含了如下字段&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;vec, 支持 vectorization 的单位&lt;/li&gt;
&lt;li&gt;perPhase, 每个 phase 包含多少个 vec&lt;/li&gt;
&lt;li&gt;maxPhase, tensor 总共包含多少个 phase&lt;/li&gt;
&lt;li&gt;order, axis 的次序&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其中，vec, perPhase, maxPhase 是用于避免 bank conflict 的 swizzle 操作需要的参数。&lt;/p&gt;
&lt;p&gt;代码中的例子：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-nil" data-lang="nil"&gt;In order to avoid shared memory bank conflicts, elements may be swizzled
in memory. For example, a swizzled row-major layout could store its data
as follows:
A_{0, 0} A_{0, 1} A_{0, 2} A_{0, 3} ... [phase 0] \ per_phase = 2
A_{1, 0} A_{1, 1} A_{1, 2} A_{1, 3} ... [phase 0] /
groups of vec=2 elements
are stored contiguously
_ _ _ _ /\_ _ _ _
A_{2, 2} A_{2, 3} A_{2, 0} A_{2, 1} ... [phase 1] \ per phase = 2
A_{3, 2} A_{3, 3} A_{3, 0} A_{3, 1} ... [phase 1] /
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start="3"&gt;
&lt;li&gt;MMA Layout&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;顾名思义，MMA Layout 表示 Tensor Core 中 MMA 指令结果的 data layout，比如 Ampere 对应的 MMA Layout 的数据排布基本可以对应到 PTX 指令中的 &lt;a href="https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#warp-level-matrix-fragment-mma-1684"&gt;mma.m16n8k16&lt;/a&gt; 的 C,D 的排布。&lt;/p&gt;
&lt;p&gt;MMA Layout 主要包含两个字段：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;version&lt;/code&gt; ，表示 TensorCore 的版本
&lt;ul&gt;
&lt;li&gt;1 为 Volta&lt;/li&gt;
&lt;li&gt;2 为 Ampere&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;warpsPerCTA&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这里演示 FP16 精度下， &lt;code&gt;version=2&lt;/code&gt; 的数据排布（会映射到 &lt;code&gt;mma.m16n8k16&lt;/code&gt; 指令）的 Accumulators (C or D) 的 &lt;a href="https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#warp-level-matrix-fragment-mma-16816-float"&gt;数据排布&lt;/a&gt;。&lt;/p&gt;
&lt;figure&gt;&lt;img src="/static/mma.16816.png"&gt;
&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start="4"&gt;
&lt;li&gt;DotOperand Layout&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;DotOperand Layout 用来表示 Triton 的 DotOp 的输入的 layout。&lt;/p&gt;
&lt;p&gt;其主要包含如下信息&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;opIdx&lt;/code&gt; ， Operand 的 ID
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;opIdx=0&lt;/code&gt; 表示 DotOp 的 $a&lt;/li&gt;
&lt;li&gt;&lt;code&gt;opIdx=1&lt;/code&gt; 表示 DotOp 的 $b&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;parent&lt;/code&gt; ，存储其对应的 MMA Layout，这里 DotOperand 的数据排布也可能间接的由 MMA Layout 确定（如果 DotOp lower 到 MMA 指令）或者 Blocked Layout（如果 DotOp lower 到 FMA 指令）&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这里为了方便演示，我们采用 MMA Layout 中的 &lt;code&gt;mma.m16n8k16.f16&lt;/code&gt; 指令&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;计算精度为 FP16&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MMA Layout&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;version=2&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;warpsPerCTA=[8,4]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;对于 $a，对应的 DotOperand 的 opIdx = 0&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$b, 对应的 DotOperand 的 opIdx = 1&lt;/p&gt;
&lt;figure&gt;&lt;img src="/static/mma.16816.op.png"&gt;
&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start="5"&gt;
&lt;li&gt;Slice Layout&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Slice Layout 表明单个维度上的数据反向索引&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="convertlayoutop"&gt;ConvertLayoutOp&lt;/h4&gt;
&lt;p&gt;顾名思义，ConvertLayoutOp 就是用来讲 Tensor 从一种 data layout 转换到另外一种 data layout。
由于 data layout 是 TensorType 的一部分，很自然会存在类型（其中layout）需要转换的情况，这就是 ConvertLayoutOp 的作用。&lt;/p&gt;
&lt;p&gt;有了上面的 Data Layout，接下来我们看最简单的 MatMul 中的的 IR：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;2&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;4&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#mma&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;mma&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;version&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt;, &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;//&lt;/span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bb60d5"&gt;%38&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bb60d5"&gt;%39&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bb60d5"&gt;%40&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%38&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;dot&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%39&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%40&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; {&lt;span style=""&gt;allowTF&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;, &lt;span style=""&gt;transA&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;, &lt;span style=""&gt;transB&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; * &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;//&lt;/span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;上面是截取了一段经典 MatMul 中某个阶段的 TritonGPU IR，逻辑比较直白，定义了 &lt;code&gt;#blocked0&lt;/code&gt;, &lt;code&gt;#blocked1&lt;/code&gt; 和 &lt;code&gt;#mma&lt;/code&gt; 三种 layout，之后通过 &lt;code&gt;tt.load&lt;/code&gt; 将 DotOp 的两个 Operand 从 GEMM 加载数据到 register files，之后两个 &lt;code&gt;triton_gpu.convert_layout&lt;/code&gt; 转换 layout 为 DotOp 的参数需要的 &lt;code&gt;#triton_gpu.dot_op&lt;/code&gt; layout。&lt;/p&gt;
&lt;p&gt;这里列举一些典型的 data layout 的转换，以及特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;#shared -&amp;gt; #blocked&lt;/code&gt; ，正常是代表数据从 shared memory 被 load 到 register file 中，需要考虑 swizzle&lt;/li&gt;
&lt;li&gt;&lt;code&gt;#blocked -&amp;gt; #shared&lt;/code&gt; ，代表数据从 register file 存储到 shared memory 中，需要上一步相同的 swizzle 方式&lt;/li&gt;
&lt;li&gt;&lt;code&gt;#mma -&amp;gt; #blocked&lt;/code&gt; ，正常是 DotOp 的输出转换为更简单的 layout 来进一步计算，由于涉及到跨 thread 间的数据传递，因此一般会借由 shared memory 中转一次&lt;/li&gt;
&lt;li&gt;&lt;code&gt;#blocked -&amp;gt; #dot_operand&lt;/code&gt; ，转换为 DotOp 的输入，这一步可能也需要 shared memory 中转&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Triton 中几乎实现了任意 data layout 间的转换，当然不同的转换代价也不尽相同（考虑到是否会用到 shared memory，register 增减量等等），因此转换的代价也会在 Optimizer 里面一并考虑。&lt;/p&gt;
&lt;h3 id="tritonir-的优化"&gt;TritonIR 的优化&lt;/h3&gt;
&lt;p&gt;TritonIR 上的优化主要是计算本身的，与硬件无关的优化，包含了如下 Pass&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Inliner Pass，将 Kernel Call 的子函数 Inline 展开&lt;/li&gt;
&lt;li&gt;Combine Pass，一些特定的 Pattern rewrite，比如
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;select(cond, load(ptrs, broadcast(cond), ???), other) =&amp;gt; load(ptrs, broadcast(cond), other)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Canonicalizer Pass，一些化简的 Pattern rewrite&lt;/li&gt;
&lt;li&gt;CSE Pass，MLIR 的 &lt;a href="https://mlir.llvm.org/docs/Passes/#-cse-eliminate-common-sub-expressions"&gt;cse&lt;/a&gt; Pass，用于 Eliminate common sub-expressions&lt;/li&gt;
&lt;li&gt;LICM Pass，MLIR 的 &lt;a href="https://mlir.llvm.org/doxygen/LoopInvariantCodeMotion_8cpp_source.html"&gt;LoopInvariantCodeMotion Pass&lt;/a&gt; ，将循环无关的变量挪到 forloop 外面&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="tritongpu-ir-的优化"&gt;TritonGPU IR 的优化&lt;/h3&gt;
&lt;p&gt;TritonGPU IR 上的优化在计算本身优化外，新增了 GPU 硬件相关的优化，具体的 Pass 列表如下&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ConvertTritonToTritonGPU Pass，将 Triton IR 转换为 TritonGPU IR，主要是增加 TritonGPU 特有的 layout&lt;/li&gt;
&lt;li&gt;Coalesce Pass，重排 order，使得最大 contiguity 的维度排在最前面&lt;/li&gt;
&lt;li&gt;Combine Pass，同 Triton IR&lt;/li&gt;
&lt;li&gt;Pipeline Pass，MMA 指令对应的 global memory 到 shared memory 的 N-Buffer 优化，下文详解&lt;/li&gt;
&lt;li&gt;Prefetch Pass，MMA 指令对应的 shared memory 到 register file 的 N-Buffer 优化，下文详解&lt;/li&gt;
&lt;li&gt;Canonicalizer，同 Triton IR&lt;/li&gt;
&lt;li&gt;CSE Pass，同 Triton IR&lt;/li&gt;
&lt;li&gt;LICM Pass，同 Triton IR&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="pipeline-pass"&gt;Pipeline Pass&lt;/h4&gt;
&lt;p&gt;Pipeline Pass 和下一小节中的 Prefetch Pass 是配合关系，整体用来为 DotOp (mma 指令) 的 Operand 提供 IO 优化。&lt;/p&gt;
&lt;p&gt;Pipeline 优化主要针对 DotOp 中 GEMM 到 SMEM 之间的数据拷贝，并自动做 Double Buffer 或者 N Buffer 的优化。&lt;/p&gt;
&lt;p&gt;最简单的 Double buffer 的伪代码如下&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;A &lt;span style="color:#666"&gt;=&lt;/span&gt; alloc_tensor(shape&lt;span style="color:#666"&gt;=&lt;/span&gt;[&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style="color:#666"&gt;*&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;,&lt;span style="color:#40a070"&gt;16&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#60a0b0;font-style:italic"&gt;# cp.async &amp;amp; cp.async.commit_group&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;A &lt;span style="color:#666"&gt;=&lt;/span&gt; insert_slice_async(A, ptr0, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;B &lt;span style="color:#666"&gt;=&lt;/span&gt; alloc_tensor(shape&lt;span style="color:#666"&gt;=&lt;/span&gt;[&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style="color:#666"&gt;*&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;,&lt;span style="color:#40a070"&gt;8&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;B &lt;span style="color:#666"&gt;=&lt;/span&gt; insert_slice_async(B, ptr1, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;A &lt;span style="color:#666"&gt;=&lt;/span&gt; insert_slice_async(A, ptr00, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;B &lt;span style="color:#666"&gt;=&lt;/span&gt; insert_slice_async(B, ptr11, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;async_wait(num&lt;span style="color:#666"&gt;=&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;) &lt;span style="color:#60a0b0;font-style:italic"&gt;# cp.async.wait_group&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;A_slice0 &lt;span style="color:#666"&gt;=&lt;/span&gt; extract_slice(A, offset&lt;span style="color:#666"&gt;=&lt;/span&gt;(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;,&lt;span style="color:#40a070"&gt;0&lt;/span&gt;,&lt;span style="color:#40a070"&gt;0&lt;/span&gt;), size&lt;span style="color:#666"&gt;=&lt;/span&gt;(&lt;span style="color:#40a070"&gt;1&lt;/span&gt;,&lt;span style="color:#40a070"&gt;16&lt;/span&gt;,&lt;span style="color:#40a070"&gt;16&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;B_slice0 &lt;span style="color:#666"&gt;=&lt;/span&gt; extract_slice(B, offset&lt;span style="color:#666"&gt;=&lt;/span&gt;(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;,&lt;span style="color:#40a070"&gt;0&lt;/span&gt;,&lt;span style="color:#40a070"&gt;0&lt;/span&gt;), size&lt;span style="color:#666"&gt;=&lt;/span&gt;(&lt;span style="color:#40a070"&gt;1&lt;/span&gt;,&lt;span style="color:#40a070"&gt;16&lt;/span&gt;,&lt;span style="color:#40a070"&gt;8&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; i &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; &lt;span style="color:#007020"&gt;range&lt;/span&gt;(&lt;span style="color:#666"&gt;...&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; a &lt;span style="color:#666"&gt;=&lt;/span&gt; ldmatrix(A_slice0)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; b &lt;span style="color:#666"&gt;=&lt;/span&gt; ldmatrix(B_slice0)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; c &lt;span style="color:#666"&gt;=&lt;/span&gt; dot(a, b)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; offset &lt;span style="color:#666"&gt;=&lt;/span&gt; (i&lt;span style="color:#666"&gt;+&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;) &lt;span style="color:#666"&gt;%&lt;/span&gt; &lt;span style="color:#40a070"&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; A &lt;span style="color:#666"&gt;=&lt;/span&gt; insert_slice_async(A, ptr2, offset)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; B &lt;span style="color:#666"&gt;=&lt;/span&gt; insert_slice_async(B, ptr3, offset)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; async_wait(num&lt;span style="color:#666"&gt;=&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; A_slice0 &lt;span style="color:#666"&gt;=&lt;/span&gt; extract_slice(A, offset&lt;span style="color:#666"&gt;=&lt;/span&gt;(offset,&lt;span style="color:#40a070"&gt;0&lt;/span&gt;,&lt;span style="color:#40a070"&gt;0&lt;/span&gt;), size&lt;span style="color:#666"&gt;=&lt;/span&gt;(&lt;span style="color:#40a070"&gt;1&lt;/span&gt;,&lt;span style="color:#40a070"&gt;16&lt;/span&gt;,&lt;span style="color:#40a070"&gt;16&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; B_slice0 &lt;span style="color:#666"&gt;=&lt;/span&gt; extract_slice(B, offset&lt;span style="color:#666"&gt;=&lt;/span&gt;(offset,&lt;span style="color:#40a070"&gt;0&lt;/span&gt;,&lt;span style="color:#40a070"&gt;0&lt;/span&gt;), size&lt;span style="color:#666"&gt;=&lt;/span&gt;(&lt;span style="color:#40a070"&gt;1&lt;/span&gt;,&lt;span style="color:#40a070"&gt;16&lt;/span&gt;,&lt;span style="color:#40a070"&gt;8&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其中，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;alloc_tensor&lt;/code&gt; 大致对应到 &lt;code&gt;triton_gpu.alloc_tensor&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;insert_slice_async&lt;/code&gt; 对应到 &lt;code&gt;triton_gpu.insert_slice_async&lt;/code&gt; ， 表示异步地向 Tensor 中插入一个 slice，这个过程是通过 &lt;code&gt;cp.async&lt;/code&gt; 指令实现的异步&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tensor.extract_slice&lt;/code&gt; 表示从 Tensor 中读取一个 slice&lt;/li&gt;
&lt;li&gt;&lt;code&gt;async_wait&lt;/code&gt; 的语义对应到 &lt;code&gt;cp.async.wait_group&lt;/code&gt; 指令&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="prefetch-pass"&gt;Prefetch Pass&lt;/h4&gt;
&lt;p&gt;Prefetch 的逻辑跟 Pipeline Pass 基本类似，也是 Double buffer 和 N Buffer 的优化，区别是其承担了 SMEM 到 register file 的数据搬运，IR 的表示方式是 &lt;code&gt;triton_gpu.convert_layout %37 : (tensor&amp;lt;16x16xf16, #blocked0&amp;gt;) -&amp;gt; tensor&amp;lt;16x16xf16, #triton_gpu.dot_op&amp;lt;{opIdx = 0, parent = #mma}&amp;gt;&amp;gt;&lt;/code&gt; ， 最终映射的核心指令是 &lt;code&gt;ldmatrix&lt;/code&gt; 。&lt;/p&gt;
&lt;h2 id="高性能-llvm-生成之-backend"&gt;高性能 LLVM 生成之 Backend&lt;/h2&gt;
&lt;p&gt;Triton 的 Backend 可以有微观和宏观两个角度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;微观上主要包括 &lt;code&gt;TritonGPU IR -&amp;gt; LLVM Dialect&lt;/code&gt; 的过程，这里需要注意的是，&lt;a href="https://mlir.llvm.org/docs/Dialects/LLVM/"&gt;LLVM Dialect&lt;/a&gt; 是 MLIR 体系中的一个表示，其可以进一步自动 lower 到 LLVM IR&lt;/li&gt;
&lt;li&gt;宏观上进一步包括了 LLVM Dialect -&amp;gt; LLVM IR -&amp;gt; PTX -&amp;gt; cubin 等过程&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这里我们只从微观角度介绍，因为宏观角度中，大部分流程可以通过 LLVM 社区或者 CUDA 的一些设施自动完成。&lt;/p&gt;
&lt;p&gt;Triton 的 Backend 是比较经典的 MLIR 的 Lowering，主要内容就是将 TritonGPU IR 中包含的每种 Op 逐个的 OpConversion。 不过为了高性能，以及保证 Codegen 产物的可控，Triton 在 LLVM 中大量插入了 PTX 的内联汇编（下文会介绍）。 此外，大部分 Op 的 Lowering 都是比较规则化，下文会简要介绍 Dot 指令的 Lowering。&lt;/p&gt;
&lt;h3 id="ptx-inline-asm"&gt;PTX inline asm&lt;/h3&gt;
&lt;p&gt;Triton 中使用 Inline asm 大致几个原因：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;一些指令对应的操作在现有的 &lt;code&gt;gpu&lt;/code&gt; 和 &lt;code&gt;nvgpu&lt;/code&gt; 的 dialect 还不太完善&lt;/li&gt;
&lt;li&gt;性能原因，比如浮点类型间的变换，一小块汇编足以；借助一个很长的 workflow 还不太可控&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Triton 里面针对 Inline asm 的封装有个简单的 wrapper，类似最简单的 &lt;code&gt;cp.async.wait_group&lt;/code&gt; 的调用&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-C++" data-lang="C++"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;PTXBuilder ptxBuilder;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;auto&lt;/span&gt; &lt;span style="color:#666"&gt;&amp;amp;&lt;/span&gt;asyncWaitOp &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#666"&gt;*&lt;/span&gt;ptxBuilder.create&lt;span style="color:#666"&gt;&amp;lt;&amp;gt;&lt;/span&gt;(&lt;span style="color:#4070a0"&gt;&amp;#34;cp.async.wait_group&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;auto&lt;/span&gt; num &lt;span style="color:#666"&gt;=&lt;/span&gt; op&lt;span style="color:#666"&gt;-&amp;gt;&lt;/span&gt;getAttrOfType&lt;span style="color:#666"&gt;&amp;lt;&lt;/span&gt;IntegerAttr&lt;span style="color:#666"&gt;&amp;gt;&lt;/span&gt;(&lt;span style="color:#4070a0"&gt;&amp;#34;num&amp;#34;&lt;/span&gt;).getInt();
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;asyncWaitOp(ptxBuilder.newConstantOperand(num));
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;到稍微复杂点的 &lt;code&gt;ld&lt;/code&gt; 的各种参数组合&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-C++" data-lang="C++"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;auto&lt;/span&gt; &lt;span style="color:#666"&gt;&amp;amp;&lt;/span&gt;ld &lt;span style="color:#666"&gt;=&lt;/span&gt; ptxBuilder.create&lt;span style="color:#666"&gt;&amp;lt;&amp;gt;&lt;/span&gt;(&lt;span style="color:#4070a0"&gt;&amp;#34;ld&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#666"&gt;-&amp;gt;&lt;/span&gt;o(&lt;span style="color:#4070a0"&gt;&amp;#34;volatile&amp;#34;&lt;/span&gt;, op.getIsVolatile())
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; .global()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; .o(&lt;span style="color:#4070a0"&gt;&amp;#34;ca&amp;#34;&lt;/span&gt;, op.getCache() &lt;span style="color:#666"&gt;==&lt;/span&gt; triton&lt;span style="color:#666"&gt;::&lt;/span&gt;CacheModifier&lt;span style="color:#666"&gt;::&lt;/span&gt;CA)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; .o(&lt;span style="color:#4070a0"&gt;&amp;#34;cg&amp;#34;&lt;/span&gt;, op.getCache() &lt;span style="color:#666"&gt;==&lt;/span&gt; triton&lt;span style="color:#666"&gt;::&lt;/span&gt;CacheModifier&lt;span style="color:#666"&gt;::&lt;/span&gt;CG)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; .o(&lt;span style="color:#4070a0"&gt;&amp;#34;L1::evict_first&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; op.getEvict() &lt;span style="color:#666"&gt;==&lt;/span&gt; triton&lt;span style="color:#666"&gt;::&lt;/span&gt;EvictionPolicy&lt;span style="color:#666"&gt;::&lt;/span&gt;EVICT_FIRST)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; .o(&lt;span style="color:#4070a0"&gt;&amp;#34;L1::evict_last&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; op.getEvict() &lt;span style="color:#666"&gt;==&lt;/span&gt; triton&lt;span style="color:#666"&gt;::&lt;/span&gt;EvictionPolicy&lt;span style="color:#666"&gt;::&lt;/span&gt;EVICT_LAST)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; .o(&lt;span style="color:#4070a0"&gt;&amp;#34;L1::cache_hint&amp;#34;&lt;/span&gt;, hasL2EvictPolicy)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; .v(nWords)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; .b(width);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="mma-指令生成"&gt;MMA 指令生成&lt;/h3&gt;
&lt;p&gt;相比于 ReduceOp 等需要跟 layout 结合的 Op 的 Lowering，DotOp 的是规则非常清晰的。&lt;/p&gt;
&lt;p&gt;这里大致提下在 Backend，一个 Dot 的工作流涉及的阶段和 Op：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;Stage&lt;/th&gt;
&lt;th&gt;Op&lt;/th&gt;
&lt;th&gt;Layout&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Load &lt;code&gt;$a&lt;/code&gt;, &lt;code&gt;$b&lt;/code&gt; 的 tile 到 SMEM&lt;/td&gt;
&lt;td&gt;&lt;code&gt;triton_gpu.insert_slice_async&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;#shared&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;从 SMEM Load 参数到 Register file&lt;/td&gt;
&lt;td&gt;&lt;code&gt;tensor.extract_slice&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;#dot_op&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;执行 MMA，结果会在 Registter file&lt;/td&gt;
&lt;td&gt;&lt;code&gt;tt.dot&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;#mma&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;所以直接跟 MMA 指令相关的其实只在第 4 步，其需要的 \(a\), \(b\) 两个参数已经通过 &lt;code&gt;tensor.extract_slice&lt;/code&gt; 拷贝到了 Register file，直接满足了 Ampere 上的 &lt;code&gt;mma&lt;/code&gt; 指令的需求。&lt;/p&gt;
&lt;p&gt;在 Ampere 架构上，一个 DotOp 会映射到多个 mma 指令，下面我们以 FP16 的 &lt;a href="https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#warp-level-matrix-fragment-mma-16816-float"&gt;mma.m16n8k16&lt;/a&gt; 指令为例，具体的任务设置如下&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Dot 计算的 tile 的尺寸是 M=32, N=16, K=16
&lt;ul&gt;
&lt;li&gt;对应着 &lt;code&gt;mma.m16n8k16&lt;/code&gt; 指令的尺寸是 &lt;code&gt;M=16, N=8, K=16&lt;/code&gt; ，因此一个 tile 需要在 m, n, k 方向展开 &lt;code&gt;2x2x1&lt;/code&gt; 总共 4 个 &lt;code&gt;mma.m16n8k16&lt;/code&gt; 指令&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;最终会有类似如下的代码&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-C++" data-lang="C++"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; (&lt;span style="color:#902000"&gt;unsigned&lt;/span&gt; k &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt;; k &lt;span style="color:#666"&gt;&amp;lt;&lt;/span&gt; numK; &lt;span style="color:#666"&gt;++&lt;/span&gt;k)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; (&lt;span style="color:#902000"&gt;unsigned&lt;/span&gt; m &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt;; m &lt;span style="color:#666"&gt;&amp;lt;&lt;/span&gt; numM; &lt;span style="color:#666"&gt;++&lt;/span&gt;m)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; (&lt;span style="color:#902000"&gt;unsigned&lt;/span&gt; n &lt;span style="color:#666"&gt;=&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt;; n &lt;span style="color:#666"&gt;&amp;lt;&lt;/span&gt; numN; &lt;span style="color:#666"&gt;++&lt;/span&gt;n) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; callMMA(m, n, k);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其中，numM, numN, numK 就对应着上面的 2, 2, 1。&lt;/p&gt;
&lt;p&gt;callMMA 的代码如上文时候 InlineAsm，类似如下代码&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-C++" data-lang="C++"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;auto&lt;/span&gt; mma &lt;span style="color:#666"&gt;=&lt;/span&gt; builder.create(&lt;span style="color:#4070a0"&gt;&amp;#34;mma.sync.aligned.m8n8k4&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#666"&gt;-&amp;gt;&lt;/span&gt;o(isARow &lt;span style="color:#666"&gt;?&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#34;row&amp;#34;&lt;/span&gt; &lt;span style="color:#666"&gt;:&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#34;col&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; .o(isBRow &lt;span style="color:#666"&gt;?&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#34;row&amp;#34;&lt;/span&gt; &lt;span style="color:#666"&gt;:&lt;/span&gt; &lt;span style="color:#4070a0"&gt;&amp;#34;col&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; .o(&lt;span style="color:#4070a0"&gt;&amp;#34;f32.f16.f16.f32&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; mma(resOprs, AOprs, BOprs, COprs);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="fyi"&gt;FYI&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/openai/triton/tree/ca05ef8e5b0b4d4834957bc31e7581b09d35c530"&gt;Triton MLIR migration code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Triton paper: &lt;a href="https://www.eecs.harvard.edu/~htk/publication/2019-mapl-tillet-kung-cox.pdf"&gt;Triton: An Intermediate Language and Compiler forTiled Neural Network Computations&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="gemm-在-optimizer-pass-效果"&gt;GEMM 在 Optimizer Pass 效果&lt;/h3&gt;
&lt;p&gt;下面列举了经典的 GEMM 在 Triton 的 Compile pipeline 里面的 IR 的变换。&lt;/p&gt;
&lt;h4 id="python-code"&gt;Python code&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;def&lt;/span&gt; &lt;span style="color:#06287e"&gt;matmul_kernel&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; a_ptr, b_ptr, c_ptr,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; stride_am, stride_ak,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; stride_bk, stride_bn,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; stride_cm, stride_cn,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; M: tl&lt;span style="color:#666"&gt;.&lt;/span&gt;constexpr, N: tl&lt;span style="color:#666"&gt;.&lt;/span&gt;constexpr, K: tl&lt;span style="color:#666"&gt;.&lt;/span&gt;constexpr,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; BLOCK_SIZE_M: tl&lt;span style="color:#666"&gt;.&lt;/span&gt;constexpr, BLOCK_SIZE_N: tl&lt;span style="color:#666"&gt;.&lt;/span&gt;constexpr,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; BLOCK_SIZE_K: tl&lt;span style="color:#666"&gt;.&lt;/span&gt;constexpr,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; offs_m &lt;span style="color:#666"&gt;=&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;arange(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, BLOCK_SIZE_M)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; offs_n &lt;span style="color:#666"&gt;=&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;arange(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, BLOCK_SIZE_N)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; offs_k &lt;span style="color:#666"&gt;=&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;arange(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, BLOCK_SIZE_K)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; a_ptrs &lt;span style="color:#666"&gt;=&lt;/span&gt; a_ptr &lt;span style="color:#666"&gt;+&lt;/span&gt; offs_m[:, &lt;span style="color:#007020;font-weight:bold"&gt;None&lt;/span&gt;] &lt;span style="color:#666"&gt;*&lt;/span&gt; stride_am &lt;span style="color:#666"&gt;+&lt;/span&gt; offs_k[&lt;span style="color:#007020;font-weight:bold"&gt;None&lt;/span&gt;, :] &lt;span style="color:#666"&gt;*&lt;/span&gt; stride_ak
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; b_ptrs &lt;span style="color:#666"&gt;=&lt;/span&gt; b_ptr &lt;span style="color:#666"&gt;+&lt;/span&gt; offs_k[:, &lt;span style="color:#007020;font-weight:bold"&gt;None&lt;/span&gt;] &lt;span style="color:#666"&gt;*&lt;/span&gt; stride_bk &lt;span style="color:#666"&gt;+&lt;/span&gt; offs_n[&lt;span style="color:#007020;font-weight:bold"&gt;None&lt;/span&gt;, :] &lt;span style="color:#666"&gt;*&lt;/span&gt; stride_bn
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; accumulator &lt;span style="color:#666"&gt;=&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;zeros((BLOCK_SIZE_M, BLOCK_SIZE_N), dtype&lt;span style="color:#666"&gt;=&lt;/span&gt;tl&lt;span style="color:#666"&gt;.&lt;/span&gt;float32)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;for&lt;/span&gt; k &lt;span style="color:#007020;font-weight:bold"&gt;in&lt;/span&gt; &lt;span style="color:#007020"&gt;range&lt;/span&gt;(&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, K, BLOCK_SIZE_K):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; a &lt;span style="color:#666"&gt;=&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;load(a_ptrs)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; b &lt;span style="color:#666"&gt;=&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;load(b_ptrs)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; accumulator &lt;span style="color:#666"&gt;+=&lt;/span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;dot(a, b)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; a_ptrs &lt;span style="color:#666"&gt;+=&lt;/span&gt; BLOCK_SIZE_K &lt;span style="color:#666"&gt;*&lt;/span&gt; stride_ak
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; b_ptrs &lt;span style="color:#666"&gt;+=&lt;/span&gt; BLOCK_SIZE_K &lt;span style="color:#666"&gt;*&lt;/span&gt; stride_bk
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; c_ptrs &lt;span style="color:#666"&gt;=&lt;/span&gt; c_ptr &lt;span style="color:#666"&gt;+&lt;/span&gt; offs_m[:, &lt;span style="color:#007020;font-weight:bold"&gt;None&lt;/span&gt;] &lt;span style="color:#666"&gt;*&lt;/span&gt; stride_cm &lt;span style="color:#666"&gt;+&lt;/span&gt; offs_n[&lt;span style="color:#007020;font-weight:bold"&gt;None&lt;/span&gt;, :] &lt;span style="color:#666"&gt;*&lt;/span&gt; stride_cn
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; tl&lt;span style="color:#666"&gt;.&lt;/span&gt;store(c_ptrs, accumulator)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="triton-ir-translated-from-python-ast--and-after-inliner-ces-dot-dot-dot-passes"&gt;Triton IR translated from Python AST(and after Inliner, CES &amp;hellip; passes)&lt;/h4&gt;
&lt;p&gt;这一步算是 Python code 直接翻译到了 Triton IR.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;fun&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style=""&gt;publi&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@matmul_kernel_0d1d2d3d4c56c78c&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style=""&gt;dense&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;0.000000e+00&lt;/span&gt;&amp;gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;64&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style=""&gt;dense&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%16&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%18&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%16&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%19&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt; = &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg6&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;step&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;iter_args&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%18&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;dot&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; {&lt;span style=""&gt;allowTF&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;, &lt;span style=""&gt;transA&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;, &lt;span style=""&gt;transB&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; * &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;yield&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%20&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%21&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%20&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%22&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%23&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%22&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%21&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%23&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;store&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%19&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;#0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="ir-before-loopinvariantcodemotion"&gt;IR Before LoopInvariantCodeMotion&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;fun&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style=""&gt;publi&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@matmul_kernel_0d1d2d3d4c56c78c&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style=""&gt;dense&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;0.000000e+00&lt;/span&gt;&amp;gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;64&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style=""&gt;dense&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%16&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%18&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%16&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%19&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt; = &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg6&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;step&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;iter_args&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%18&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;dot&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; {&lt;span style=""&gt;allowTF&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;, &lt;span style=""&gt;transA&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;, &lt;span style=""&gt;transB&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; * &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;yield&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%20&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%21&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%20&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%22&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%23&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%22&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%21&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%23&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;store&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%19&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;#0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;可以看到&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这段计算的输入分别是 function argument 和 constant，不依赖 forloop 内的变量，理论上可以挪出去。&lt;/p&gt;
&lt;h4 id="ir-after-loopinvariantcodemotion"&gt;IR After LoopInvariantCodeMotion&lt;/h4&gt;
&lt;p&gt;LoopInvariantCodeMotion 是 MLIR 社区的一个 Pass，用于将无关 variable 计算挪到 forloop 外面，可以看到上小节里面的计算已经挪出去了。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;fun&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style=""&gt;publi&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@matmul_kernel_0d1d2d3d4c56c78c&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style=""&gt;dense&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;0.000000e+00&lt;/span&gt;&amp;gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;64&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style=""&gt;dense&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%16&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%18&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%16&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%19&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%20&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%19&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%21&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt; = &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg6&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;step&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;iter_args&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%18&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;dot&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; {&lt;span style=""&gt;allowTF&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;, &lt;span style=""&gt;transA&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;, &lt;span style=""&gt;transB&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; * &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%20&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;yield&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%22&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%23&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%22&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%23&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;store&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%21&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;#0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="ir-after-converttritontotritongpu"&gt;IR After ConvertTritonToTritonGPU&lt;/h4&gt;
&lt;p&gt;这一步是在原有的硬件无关的 Triton IR 基础上加入了 GPU 相关的 data layout 和 operation.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;2&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;5&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;module&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;attributes&lt;/span&gt; {&lt;span style="color:#4070a0"&gt;&amp;#34;triton_gpu.num-warps&amp;#34;&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;fun&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style=""&gt;publi&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@matmul_kernel_0d1d2d3d4c56c78c&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style=""&gt;dense&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;0.000000e+00&lt;/span&gt;&amp;gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;|\colorbo&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;{&lt;span style=""&gt;yellow&lt;/span&gt;}{&lt;span style=""&gt;\strut&lt;/span&gt; &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;}&lt;span style=""&gt;|&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;64&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style=""&gt;dense&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;}&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;}&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%16&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%18&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%19&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;5&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%20&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%19&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;5&lt;/span&gt;}&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;5&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%21&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%18&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%22&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%21&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%23&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%20&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;5&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;5&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%23&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;5&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%22&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt; = &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg6&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;step&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;iter_args&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%36&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%38&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%36&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%39&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%40&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;dot&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%38&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%39&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; {&lt;span style=""&gt;allowTF&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;, &lt;span style=""&gt;transA&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;, &lt;span style=""&gt;transB&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;}&amp;gt;&amp;gt; * &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;}&amp;gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%42&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;yield&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%40&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%42&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%33&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%34&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%33&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%35&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%34&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;store&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%35&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;#0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这里比较明显的是&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;作为 dotOp 的输出， &lt;code&gt;%40&lt;/code&gt; 应该是 mma layout，但这一步还是 blocked layout，这个会在下一节里面改写&lt;/li&gt;
&lt;li&gt;&lt;code&gt;%38&lt;/code&gt;, &lt;code&gt;%39&lt;/code&gt; 这些的 layout 应该是 &lt;code&gt;dot_op&amp;lt;mma&amp;gt;&lt;/code&gt; 但由于 mma layout 还没有给定，所以还是 &lt;code&gt;dot_op&amp;lt;blocked&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id="ir-after-tritongpucombineops"&gt;IR After TritonGPUCombineOps&lt;/h4&gt;
&lt;p&gt;这一步会包含很多 Op pattern 的改写，直接的变化是&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;给 dot 相关的增加了 mma 的 data layout&lt;/li&gt;
&lt;li&gt;插入了 mma layout 相关的 &lt;code&gt;convert_layout&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;2&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;4&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt;&lt;span style=""&gt;#mma&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;mma&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;version&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt;, &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;module&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;attributes&lt;/span&gt; {&lt;span style="color:#4070a0"&gt;&amp;#34;triton_gpu.num-warps&amp;#34;&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;fun&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style=""&gt;publi&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@matmul_kernel_0d1d2d3d4c56c78c&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;64&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style=""&gt;dense&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;0.000000e+00&lt;/span&gt;&amp;gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style=""&gt;dense&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;}&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;}&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%10&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;make_range&lt;/span&gt; {&lt;span style="color:#007020;font-weight:bold"&gt;end&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;start&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%16&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;}&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%16&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%12&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%18&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%13&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%17&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%19&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%18&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%20&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%14&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;}&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%21&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%20&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%22&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%15&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;}&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%23&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%22&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c16_i32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%24&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%11&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%19&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%21&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt; = &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg6&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;step&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;iter_args&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%38&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;load&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; {&lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%39&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%40&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%38&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;dot&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%39&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%40&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; {&lt;span style=""&gt;allowTF&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;, &lt;span style=""&gt;transA&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;, &lt;span style=""&gt;transB&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; * &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%42&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%43&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;yield&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%42&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%43&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;expand_dims&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;slice&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;dim&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;}&amp;gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;muli&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%33&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%34&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;broadcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%33&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%35&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%34&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%23&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%36&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;#0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;store&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%35&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%36&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="ir-after-tritongpupipeline"&gt;IR After TritonGPUPipeline&lt;/h4&gt;
&lt;p&gt;这一步可以认为是在 global memory -&amp;gt; shared memory 的数据搬运做 Pipeline 优化。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;2&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;4&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#mma&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;mma&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;version&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt;, &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;shared&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;ve&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt;, &lt;span style=""&gt;perPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;4&lt;/span&gt;, &lt;span style=""&gt;maxPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt;, &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;shared&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;ve&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt;, &lt;span style=""&gt;perPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt;, &lt;span style=""&gt;maxPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;module&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;attributes&lt;/span&gt; {&lt;span style="color:#4070a0"&gt;&amp;#34;triton_gpu.num-warps&amp;#34;&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;fun&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style=""&gt;publi&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@matmul_kernel_0d1d2d3d4c56c78c&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;cmpi&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;slt&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt; = &lt;span style="color:#002070;font-weight:bold"&gt;triton_gpu.alloc_tensor :&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c0_i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; = &lt;span style="color:#002070;font-weight:bold"&gt;triton_gpu.alloc_tensor :&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%33&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%34&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c0_i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%33&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%35&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%36&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%40&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%39&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%35&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%40&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%42&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%39&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%43&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%36&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%34&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%42&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%44&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%35&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%45&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%36&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_1&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%46&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;async_wait&lt;/span&gt; {&lt;span style=""&gt;num&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c0_i32_2&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%47&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt;[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%48&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%43&lt;/span&gt;[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_3&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%49&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c0_i32_2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%50&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt;&lt;span style="color:#40a070"&gt;12&lt;/span&gt; = &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg6&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;step&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;iter_args&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg10&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg11&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%43&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg12&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%47&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg13&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%48&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg14&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%45&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg15&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%44&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg16&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%38&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg17&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%46&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg18&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%49&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%59&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg12&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%60&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg13&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%61&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;dot&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%59&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%60&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; {&lt;span style=""&gt;allowTF&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;, &lt;span style=""&gt;transA&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;, &lt;span style=""&gt;transB&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; * &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%62&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%63&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%64&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg16&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%65&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;cmpi&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;slt&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%64&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c3_i32&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%66&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;remsi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg17&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c3_i32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c3_i32_4&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%67&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;remsi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg18&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c3_i32_4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%68&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;index_cast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%67&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%69&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%65&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%70&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg15&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg10&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%66&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%69&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%71&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%65&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%72&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg14&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg11&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%66&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%71&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%73&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg15&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%74&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg14&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;async_wait&lt;/span&gt; {&lt;span style=""&gt;num&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%75&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%70&lt;/span&gt;[&lt;span style="color:#bb60d5"&gt;%68&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%76&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%72&lt;/span&gt;[&lt;span style="color:#bb60d5"&gt;%68&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_5&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%77&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg17&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_5&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_6&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%78&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg18&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_6&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;yield&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%61&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%62&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%63&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%70&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%72&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%75&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%76&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%74&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%73&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%64&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%77&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%78&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="ir-before-tritongpuprefetch"&gt;IR Before TritonGPUPrefetch&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;2&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;4&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#mma&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;mma&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;version&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt;, &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;shared&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;ve&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt;, &lt;span style=""&gt;perPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;4&lt;/span&gt;, &lt;span style=""&gt;maxPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt;, &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;shared&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;ve&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt;, &lt;span style=""&gt;perPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt;, &lt;span style=""&gt;maxPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;module&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;attributes&lt;/span&gt; {&lt;span style="color:#4070a0"&gt;&amp;#34;triton_gpu.num-warps&amp;#34;&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;fun&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style=""&gt;publi&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@matmul_kernel_0d1d2d3d4c56c78c&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt;, &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;cmpi&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;slt&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt; = &lt;span style="color:#002070;font-weight:bold"&gt;triton_gpu.alloc_tensor :&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%29&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c0_i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%30&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt; = &lt;span style="color:#002070;font-weight:bold"&gt;triton_gpu.alloc_tensor :&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%33&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%28&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%34&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c0_i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%33&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%35&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%36&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%40&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%39&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%35&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%31&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%40&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%42&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%39&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%43&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%36&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%34&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%42&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%44&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%35&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%45&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%36&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_1&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%46&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%37&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;async_wait&lt;/span&gt; {&lt;span style=""&gt;num&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c0_i32_2&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%47&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt;[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%48&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%43&lt;/span&gt;[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_3&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%49&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c0_i32_2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%50&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt;&lt;span style="color:#40a070"&gt;12&lt;/span&gt; = &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg6&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;step&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;iter_args&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg10&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg11&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%43&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg12&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%47&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg13&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%48&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg14&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%45&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg15&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%44&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg16&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%38&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg17&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%46&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg18&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%49&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%59&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg12&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%60&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg13&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%61&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;dot&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%59&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%60&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; {&lt;span style=""&gt;allowTF&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;, &lt;span style=""&gt;transA&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;, &lt;span style=""&gt;transB&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; * &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%62&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%63&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%64&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg16&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%65&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;cmpi&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;slt&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%64&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c3_i32&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%66&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;remsi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg17&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c3_i32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c3_i32_4&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%67&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;remsi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg18&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c3_i32_4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%68&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;index_cast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%67&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%69&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%65&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%70&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg15&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg10&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%66&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%69&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%71&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%65&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%72&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg14&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg11&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%66&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%71&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%73&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg15&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%74&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg14&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;async_wait&lt;/span&gt; {&lt;span style=""&gt;num&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%75&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%70&lt;/span&gt;[&lt;span style="color:#bb60d5"&gt;%68&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%76&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%72&lt;/span&gt;[&lt;span style="color:#bb60d5"&gt;%68&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_5&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%77&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg17&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_5&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_6&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%78&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg18&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_6&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;yield&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%61&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%62&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%63&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%70&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%72&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%75&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%76&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%74&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%73&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%64&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%77&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%78&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="ir-after-tritongpuprefetch"&gt;IR After TritonGPUPrefetch&lt;/h4&gt;
&lt;p&gt;这一步可以认为是在 Dot 相关的 shared memory -&amp;gt; registers 的数据搬运阶段做 Pipepline 优化。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;2&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;blocked&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;sizePerThread&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;threadsPerWarp&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;4&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;], &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;], &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#mma&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;mma&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;version&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt;, &lt;span style=""&gt;warpsPerCTA&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;shared&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;ve&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt;, &lt;span style=""&gt;perPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;4&lt;/span&gt;, &lt;span style=""&gt;maxPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt;, &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt; = &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;shared&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;ve&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt;, &lt;span style=""&gt;perPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;8&lt;/span&gt;, &lt;span style=""&gt;maxPhase&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;order&lt;/span&gt; = [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;]}&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;module&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;attributes&lt;/span&gt; {&lt;span style="color:#4070a0"&gt;&amp;#34;triton_gpu.num-warps&amp;#34;&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;fun&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style=""&gt;publi&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@matmul_kernel_0d1d2d3d4c56c78c&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;async_wait&lt;/span&gt; {&lt;span style=""&gt;num&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c0_i32_2&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%47&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt;[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%48&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%43&lt;/span&gt;[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_3&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%49&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c0_i32_2&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%50&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%47&lt;/span&gt;[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%51&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%50&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%52&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%48&lt;/span&gt;[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%53&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%52&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%54&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt;&lt;span style="color:#40a070"&gt;14&lt;/span&gt; = &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg6&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%c0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;step&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;iter_args&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%cst&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%26&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%27&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg10&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%41&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg11&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%43&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg12&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%47&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg13&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%48&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg14&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%45&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg15&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%44&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg16&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%38&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg17&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%46&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg18&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%49&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg19&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%51&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg20&lt;/span&gt; = &lt;span style="color:#bb60d5"&gt;%53&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%63&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg12&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%64&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg13&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%65&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;dot&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%63&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%64&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; {&lt;span style=""&gt;allowTF&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;, &lt;span style=""&gt;transA&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;, &lt;span style=""&gt;transB&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; * &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%66&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;dot&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg19&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg20&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg7&lt;/span&gt; {&lt;span style=""&gt;allowTF&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;, &lt;span style=""&gt;transA&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;, &lt;span style=""&gt;transB&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; * &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%67&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg8&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%68&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg9&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%69&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg16&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%70&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;cmpi&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;slt&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%69&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c64&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c3_i32&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%71&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;remsi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg17&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c3_i32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c3_i32_4&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%72&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;remsi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg18&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c3_i32_4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%73&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;index_cast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%72&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%74&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%70&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%75&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg15&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg10&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%71&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%74&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%76&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;splat&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%70&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%77&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;insert_slice_asyn&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg14&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%arg11&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%71&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%76&lt;/span&gt; {&lt;span style=""&gt;axis&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;cache&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;evict&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;isVolatile&lt;/span&gt; = &lt;span style="color:#007020;font-weight:bold"&gt;false&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%78&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg15&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%cst_0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%79&lt;/span&gt; = &lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;addptr&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg14&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%25&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;async_wait&lt;/span&gt; {&lt;span style=""&gt;num&lt;/span&gt; = &lt;span style="color:#40a070"&gt;2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%80&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%75&lt;/span&gt;[&lt;span style="color:#bb60d5"&gt;%73&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%81&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%77&lt;/span&gt;[&lt;span style="color:#bb60d5"&gt;%73&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_5&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%82&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg17&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_5&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%c1_i32_6&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt; &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%83&lt;/span&gt; = &lt;span style=""&gt;arith&lt;/span&gt;.&lt;span style=""&gt;addi&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%arg18&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%c1_i32_6&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%84&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%80&lt;/span&gt;[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;16&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%85&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%84&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%86&lt;/span&gt; = &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;.&lt;span style=""&gt;extract_slice&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%81&lt;/span&gt;[&lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style="color:#40a070"&gt;0&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;8&lt;/span&gt;] [&lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;] &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%87&lt;/span&gt; = &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;convert_layout&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%86&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;scf&lt;/span&gt;.&lt;span style=""&gt;yield&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%65&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%67&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%68&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%75&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%77&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%80&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%81&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%79&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%78&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%69&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%82&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%83&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%85&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%87&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;#mma&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;3&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#shared&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;&lt;span style="color:#bb60d5"&gt;!tt.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;#blocked&lt;/span&gt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;0&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;, &lt;span style=""&gt;tens&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&lt;span style=""&gt;x&lt;/span&gt;&lt;span style="color:#40a070"&gt;8&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style=""&gt;#triton_gpu&lt;/span&gt;.&lt;span style=""&gt;dot_op&lt;/span&gt;&amp;lt;{&lt;span style=""&gt;opId&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt;, &lt;span style=""&gt;parent&lt;/span&gt; = &lt;span style=""&gt;#mma&lt;/span&gt;}&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="ir-after-tritongputollvm"&gt;IR After TritonGPUToLLVM&lt;/h4&gt;
&lt;p&gt;MLIR 阶段的最后一步就是 translate 到 LLVM dialect，可以看到其中 Triton backend 插入的 Inline Asm。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"&gt;&lt;code class="language-llvm" data-lang="llvm"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;module&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;attributes&lt;/span&gt; {&lt;span style="color:#4070a0"&gt;&amp;#34;triton_gpu.num-warps&amp;#34;&lt;/span&gt; = &lt;span style="color:#40a070"&gt;4&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;triton_gpu&lt;/span&gt;.&lt;span style=""&gt;shared&lt;/span&gt; = &lt;span style="color:#40a070"&gt;36864&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;mlir&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;global&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;external&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@global_smem&lt;/span&gt;() {&lt;span style=""&gt;addr_space&lt;/span&gt; = &lt;span style="color:#40a070"&gt;3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;} &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!llvm.array&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i8&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;fun&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;c&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@matmul_kernel_0d1d2d3d4c5d6c7d8c&lt;/span&gt;(&lt;span style="color:#bb60d5"&gt;%arg0&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!llvm.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg1&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!llvm.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg2&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!llvm.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg3&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg4&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}, &lt;span style="color:#bb60d5"&gt;%arg5&lt;/span&gt;&lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt; {&lt;span style=""&gt;tt&lt;/span&gt;.&lt;span style=""&gt;divisibility&lt;/span&gt; = &lt;span style="color:#40a070"&gt;16&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;}) &lt;span style="color:#007020;font-weight:bold"&gt;attributes&lt;/span&gt; {&lt;span style=""&gt;nvvm&lt;/span&gt;.&lt;span style=""&gt;kernel&lt;/span&gt; = &lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;u&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;, &lt;span style=""&gt;nvvm&lt;/span&gt;.&lt;span style=""&gt;maxntid&lt;/span&gt; = &lt;span style="color:#40a070"&gt;128&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style=""&gt;sym_visibility&lt;/span&gt; = &lt;span style="color:#4070a0"&gt;&amp;#34;public&amp;#34;&lt;/span&gt;} {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;mlir&lt;/span&gt;.&lt;span style=""&gt;addressof&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;@global_smem&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!llvm.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;array&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i8&lt;/span&gt;&amp;gt;, &lt;span style="color:#40a070"&gt;3&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%1&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;bitcast&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!llvm.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;array&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i8&lt;/span&gt;&amp;gt;, &lt;span style="color:#40a070"&gt;3&lt;/span&gt;&amp;gt; &lt;span style="color:#007020;font-weight:bold"&gt;to&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;!llvm.ptr&lt;/span&gt;&amp;lt;&lt;span style="color:#007020;font-weight:bold"&gt;i8&lt;/span&gt;, &lt;span style="color:#40a070"&gt;3&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%2&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;mlir&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt;(&lt;span style="color:#40a070"&gt;3&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%3&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;mlir&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt;(&lt;span style="color:#40a070"&gt;1&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%4&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;mlir&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt;(&lt;span style="color:#40a070"&gt;0&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%5&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;mlir&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt;(&lt;span style="color:#40a070"&gt;2&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;mlir&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt;(&lt;span style="color:#007020;font-weight:bold"&gt;true&lt;/span&gt;) &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%7&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;mlir&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt;(&lt;span style="color:#40a070"&gt;32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;inde&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;x&lt;/span&gt;) &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%8&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;mlir&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt;(&lt;span style="color:#40a070"&gt;32&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;) &lt;span style=""&gt;:&lt;/span&gt; &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%9&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;mlir&lt;/span&gt;.&lt;span style="color:#007020;font-weight:bold"&gt;constant&lt;/span&gt;(&lt;span style="color:#40a070"&gt;0.000000e+00&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;) &lt;span style=""&gt;:&lt;/span&gt; &lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%567&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;inline_&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;asm&lt;/span&gt; &lt;span style=""&gt;has_side_effects&lt;/span&gt; &lt;span style=""&gt;asm_dialect&lt;/span&gt; = &lt;span style=""&gt;att&lt;/span&gt; &lt;span style=""&gt;operand_attrs&lt;/span&gt; = [] &lt;span style="color:#4070a0"&gt;&amp;#34;ldmatrix.sync.aligned.m8n8.x4.shared.b16 { $0, $1, $2, $3 }, [ $4 + 0 ];&amp;#34;&lt;/span&gt;, &lt;span style="color:#4070a0"&gt;&amp;#34;=r,=r,=r,=r,r&amp;#34;&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%566&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#bb60d5"&gt;!llvm.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;, &lt;span style="color:#40a070"&gt;3&lt;/span&gt;&amp;gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style="color:#bb60d5"&gt;!llvm.struct&lt;/span&gt;&amp;lt;(&lt;span style=""&gt;vect&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;vect&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;vect&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;vect&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;)&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%765&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;inline_&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;asm&lt;/span&gt; &lt;span style=""&gt;has_side_effects&lt;/span&gt; &lt;span style=""&gt;asm_dialect&lt;/span&gt; = &lt;span style=""&gt;att&lt;/span&gt; &lt;span style=""&gt;operand_attrs&lt;/span&gt; = [] &lt;span style="color:#4070a0"&gt;&amp;#34;mma.sync.aligned.m16n8k16.row.col.f32.f16.f16.f32 { $0, $1, $2, $3 }, { $4, $5, $6, $7 }, { $8, $9 }, { $10, $11, $12, $13 };&amp;#34;&lt;/span&gt;, &lt;span style="color:#4070a0"&gt;&amp;#34;=r,=r,=r,=r,r,r,r,r,r,r,0,1,2,3&amp;#34;&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%677&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%679&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%678&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%680&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%685&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%686&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%701&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%702&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%703&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%704&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style=""&gt;vect&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;vect&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;vect&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;vect&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;vect&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;vect&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;or&lt;/span&gt;&amp;lt;&lt;span style="color:#40a070"&gt;2&lt;/span&gt;&lt;span style=""&gt;xf&lt;/span&gt;&lt;span style="color:#40a070"&gt;16&lt;/span&gt;&amp;gt;, &lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style="color:#bb60d5"&gt;!llvm.struct&lt;/span&gt;&amp;lt;(&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;)&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex; background-color:#d8d8d8"&gt;&lt;span&gt; &lt;span style="color:#bb60d5"&gt;%1789&lt;/span&gt; = &lt;span style=""&gt;llvm&lt;/span&gt;.&lt;span style=""&gt;inline_&lt;/span&gt;&lt;span style="color:#007020;font-weight:bold"&gt;asm&lt;/span&gt; &lt;span style=""&gt;has_side_effects&lt;/span&gt; &lt;span style=""&gt;asm_dialect&lt;/span&gt; = &lt;span style=""&gt;att&lt;/span&gt; &lt;span style=""&gt;operand_attrs&lt;/span&gt; = [] &lt;span style="color:#4070a0"&gt;&amp;#34;@$5 st.global.v4.b32 [ $4 + 0 ], { $0, $1, $2, $3 };&amp;#34;&lt;/span&gt;, &lt;span style="color:#4070a0"&gt;&amp;#34;r,r,r,r,l,b&amp;#34;&lt;/span&gt; &lt;span style="color:#bb60d5"&gt;%1782&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%1784&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%1786&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%1788&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%1449&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;%6&lt;/span&gt; &lt;span style=""&gt;:&lt;/span&gt; (&lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i32&lt;/span&gt;, &lt;span style="color:#bb60d5"&gt;!llvm.ptr&lt;/span&gt;&amp;lt;&lt;span style=""&gt;f&lt;/span&gt;&lt;span style="color:#40a070"&gt;32&lt;/span&gt;, &lt;span style="color:#40a070"&gt;1&lt;/span&gt;&amp;gt;, &lt;span style="color:#007020;font-weight:bold"&gt;i1&lt;/span&gt;) &lt;span style=""&gt;-&lt;/span&gt;&amp;gt; &lt;span style="color:#bb60d5"&gt;!llvm.void&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>