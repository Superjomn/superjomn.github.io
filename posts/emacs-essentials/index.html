<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=stylesheet type=text/css href=/css/bootstrap.min.css><link rel=stylesheet type=text/css href=/css/style.css><title>Superjomn's blog | Emacs Essentials</title>
<meta name=google-site-verification content="kO2XszgjIr1OyaOubGpeb0M34ADBz27vyI1dLETarCM"></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z60BDN3JGH"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z60BDN3JGH")</script><body><div id=nav-border class=container><nav id=nav class="nav justify-content-center"><a class=nav-link href=/><i data-feather=home></i>
Home
</a><a class=nav-link href=/tags/tech><i data-feather=terminal></i>
Tech
</a><a class=nav-link href=/tags/life><i data-feather=coffee></i>
Life
</a><a class=nav-link href=/posts/><i data-feather=archive></i>
Archive
</a><a class=nav-link href=/tags/><i data-feather=tag></i>
Tags
</a><a class=nav-link href=/posts/about/><i data-feather=info></i>
About</a></nav></div><div class=container><main id=main><main><article><h1>Emacs Essentials</h1><i data-feather=calendar></i> <time datetime=2022-10-15>Oct 15, 2022</time>
<span id=social></span><i data-feather=tag></i>
<a class="btn btn-sm btn-outline-dark tag-btn" href=/tags/emacs>emacs</a>
<a class="btn btn-sm btn-outline-dark tag-btn" href=/tags/tech>tech</a><br><br><p><b>Table of Contents</b></p><aside><nav id=TableOfContents><ol><li><a href=#builtin-methods>builtin methods</a><ol><li><a href=#buffer>buffer</a><ol><li><a href=#current-buffer-get-the-current-buffer>current-buffer: get the current buffer</a></li><li><a href=#get-buffer-get-a-buffer-by-name>get-buffer: get a buffer by name</a></li><li><a href=#get-buffer-create-create-the-buffer-if-not-exist>get-buffer-create: create the buffer if not exist</a></li><li><a href=#changing-the-current-buffer>changing the current buffer</a></li><li><a href=#goto-a-buffer>Goto a buffer</a></li><li><a href=#changing-the-current-buffer-safely>Changing the current buffer safely</a></li><li><a href=#working-with-file-buffers>Working with file buffers</a></li><li><a href=#loading-a-file-into-a-buffer-without-display-it>Loading a file into a buffer without display it</a></li><li><a href=#get-all-buffer-names>Get all buffer names</a></li><li><a href=#save-execution-operate-on-other-buffers-without-altering-the-current-context>save-execution: Operate on other buffers without altering the current context</a></li></ol></li><li><a href=#point>point</a><ol><li><a href=#moving-the-point>Moving the point</a></li><li><a href=#preserving-the-point>Preserving the point</a></li><li><a href=#examining-buffer-text>Examining buffer text</a></li><li><a href=#the-thing>The Thing</a></li><li><a href=#serching-for-text>Serching for text</a></li><li><a href=#inserting-text>Inserting text</a></li><li><a href=#deleting-text>Deleting text</a></li><li><a href=#saving-a-buffer>Saving a buffer</a></li></ol></li><li><a href=#org-model-programming>org-model programming</a><ol><li><a href=#tags-related>Tags related</a></li><li><a href=#properties-related>Properties related</a></li></ol></li><li><a href=#file-and-path>file and path</a><ol><li><a href=#get-the-path-of-the-current-file>Get the path of the current file</a></li><li><a href=#get-path-without-suffix>Get path without suffix</a></li><li><a href=#write-to-file>Write to file</a></li></ol></li><li><a href=#execute-shell-command>execute shell command</a></li><li><a href=#condition-case-try-catch-in-elisp>condition-case: try-catch in elisp</a></li></ol></li><li><a href=#modern-libraries>Modern libraries</a><ol><li><a href=#ht-dot-el-for-hashtables>ht.el for hashtables</a><ol><li><a href=#creating-a-hash-table>creating a hash table</a></li><li><a href=#accessing-the-hash-table>accessing the hash table</a></li><li><a href=#iterating-over-the-hash-table>Iterating over the hash table</a></li></ol></li></ol></li><li><a href=#debug-and-development-in-elisp>Debug and development in Elisp</a></li></ol></nav></aside><br><p>It is a steep learning curve to master Emacs lisp, there are mainly two issues in it from my experience</p><ol><li>the lisp syntax and functional programming</li><li>the fragmented methods and libraries</li></ol><p>For the 1st issue, it is easy to master the syntax after writing several programs and getting used to them, but for the 2nd one, one needs to take notes or remember something.</p><p>In this blog, I focus on the 2nd point and keep updating the notes of some methods and libraries that I think are essential for writing Emacs lisp packages.</p><h2 id=builtin-methods>builtin methods</h2><h3 id=buffer>buffer</h3><h4 id=current-buffer-get-the-current-buffer>current-buffer: get the current buffer</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>current-buffer</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#&lt;buffer emacs-essentials.org&gt;
</span></span></code></pre></div><h4 id=get-buffer-get-a-buffer-by-name>get-buffer: get a buffer by name</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>get-buffer</span> <span style=color:#4070a0>&#34;*scratch*&#34;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#&lt;buffer *scratch*&gt;
</span></span></code></pre></div><h4 id=get-buffer-create-create-the-buffer-if-not-exist>get-buffer-create: create the buffer if not exist</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>get-buffer-create</span> <span style=color:#4070a0>&#34;yaya&#34;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#&lt;buffer yaya&gt;
</span></span></code></pre></div><h4 id=changing-the-current-buffer>changing the current buffer</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>progn</span>
</span></span><span style=display:flex><span>  (<span style=color:#06287e>set-buffer</span> (<span style=color:#06287e>get-buffer</span> <span style=color:#4070a0>&#34;*scratch*&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#06287e>current-buffer</span>))
</span></span></code></pre></div><h4 id=goto-a-buffer>Goto a buffer</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>with-current-buffer</span> <span style=color:#4070a0>&#34;*BUF*&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#60a0b0;font-style:italic>;; do something like progn</span>
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><h4 id=changing-the-current-buffer-safely>Changing the current buffer safely</h4><p>It will return to the original buffer after the operation finished.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>progn</span>
</span></span><span style=display:flex><span>  (<span style=color:#007020>save-current-buffer</span>
</span></span><span style=display:flex><span>    (<span style=color:#06287e>set-buffer</span> <span style=color:#4070a0>&#34;*scratch*&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#06287e>message</span> <span style=color:#4070a0>&#34;Current buffer: %s&#34;</span> (<span style=color:#06287e>current-buffer</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#06287e>current-buffer</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#&lt;buffer 20210801162858-emacs_lisp.org&gt;
</span></span></code></pre></div><h4 id=working-with-file-buffers>Working with file buffers</h4><p>To get the full file path for the file that the buffer represents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>buffer-file-name</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>/Users/yanchunwei/project/myblog2022/content-org/emacs-essentials.org
</span></span></code></pre></div><p>To find a buffer that represents a particular file</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>get-file-buffer</span> <span style=color:#4070a0>&#34;/Users/yanchunwei/project/myblog2022/content-org/emacs-essentials.org&#34;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#&lt;buffer emacs-essentials.org&gt;
</span></span></code></pre></div><h4 id=loading-a-file-into-a-buffer-without-display-it>Loading a file into a buffer without display it</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>find-file-noselect</span> <span style=color:#4070a0>&#34;xx.org&#34;</span>)
</span></span></code></pre></div><h4 id=get-all-buffer-names>Get all buffer names</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>mapcar</span> <span style=color:#06287e>#&#39;buffer-name</span> (<span style=color:#06287e>buffer-list</span>))
</span></span></code></pre></div><h4 id=save-execution-operate-on-other-buffers-without-altering-the-current-context>save-execution: Operate on other buffers without altering the current context</h4><p>Buffer is a core data structure in elisp, so it is normial to switch to other buffers, do some operations and return back. <code>save-execution</code> helps to restore the previous context when switching to other buffers.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>save-excursion</span>
</span></span><span style=display:flex><span>  (<span style=color:#007020>progn</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#60a0b0;font-style:italic>;; do anything on other buffers</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>;; Return to the previous context: buffer and point</span>
</span></span></code></pre></div><h3 id=point>point</h3><p>The &ldquo;point&rdquo; is the location of the cursor in the buffer.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>point</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>7508
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>point-max</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>8010
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>point-min</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>1
</span></span></code></pre></div><h4 id=moving-the-point>Moving the point</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>goto-char</span> <span style=color:#40a070>1</span>)
</span></span><span style=display:flex><span>(<span style=color:#06287e>goto-char</span> (<span style=color:#06287e>point-max</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>;; goto the begining of the buffer</span>
</span></span><span style=display:flex><span>(<span style=color:#bb60d5>beginning-of-buffer</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>;; goto the end of the buffer</span>
</span></span><span style=display:flex><span>(<span style=color:#bb60d5>end-of-buffer</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#06287e>forward-char</span>)
</span></span><span style=display:flex><span>(<span style=color:#06287e>forward-char</span> <span style=color:#40a070>5</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#06287e>forward-word</span>)
</span></span><span style=display:flex><span>(<span style=color:#bb60d5>backward-word</span>)
</span></span></code></pre></div><h4 id=preserving-the-point>Preserving the point</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>save-excursion</span>
</span></span><span style=display:flex><span>  (<span style=color:#06287e>goto-char</span> (<span style=color:#06287e>point-max</span>))
</span></span><span style=display:flex><span>  (<span style=color:#06287e>point</span>)
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>8471
</span></span></code></pre></div><h4 id=examining-buffer-text>Examining buffer text</h4><p>To look at text in the buffer.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>char-after</span>)
</span></span><span style=display:flex><span>(<span style=color:#06287e>char-after</span> (<span style=color:#06287e>point</span>))
</span></span><span style=display:flex><span>(<span style=color:#06287e>char-after</span> (<span style=color:#06287e>point-min</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>58
</span></span></code></pre></div><h4 id=the-thing>The Thing</h4><p>The <code>thing-at-point</code> function is very useful for grabbing the text at the point if it matches a particular type of &ldquo;thing&rdquo;.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>thing-at-point</span> <span style=color:#517918>&#39;word</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>thing-at-point</span> <span style=color:#517918>&#39;sentence</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>(thing-at-point &#39;sentence)
</span></span><span style=display:flex><span>#+END_SRC
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>thing-at-point</span> <span style=color:#517918>&#39;sentence</span> <span style=color:#60add5>t</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>(thing-at-point &#39;sentence t)
</span></span><span style=display:flex><span>#+END_SRC
</span></span></code></pre></div><h4 id=serching-for-text>Serching for text</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>search-forward</span> <span style=color:#4070a0>&#34;thing&#34;</span>)
</span></span></code></pre></div><h4 id=inserting-text>Inserting text</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#06287e>insert</span> <span style=color:#4070a0>&#34;000&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#06287e>insert</span> <span style=color:#4070a0>&#34;\n&#34;</span> <span style=color:#4070a0>&#34;This is&#34;</span> <span style=color:#4070a0>?\s</span> <span style=color:#4070a0>?\n</span> <span style=color:#4070a0>&#34;Sparta!&#34;</span>)
</span></span></code></pre></div><h4 id=deleting-text>Deleting text</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>with-current-buffer</span> <span style=color:#4070a0>&#34;.gitignore&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#06287e>delete-region</span> (<span style=color:#06287e>point</span>) (<span style=color:#06287e>point-max</span>)))
</span></span></code></pre></div><h4 id=saving-a-buffer>Saving a buffer</h4><p>To save the contents of a buffer back to the file it is associated with</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>save-buffer</span>)
</span></span></code></pre></div><h3 id=org-model-programming>org-model programming</h3><h4 id=tags-related>Tags related</h4><p>Tags in org-mode are as below:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-org data-lang=org><span style=display:flex><span><span style=color:navy;font-weight:700>*</span><span style=font-weight:700> heading</span><span style=font-style:italic> :tag0:tag1:</span>
</span></span></code></pre></div><ul><li><p>Get tags</p><p>To get tags on the current entry:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>org-get-tags</span>)
</span></span></code></pre></div></li></ul><ul><li><p>Set tags</p><p>To set tags on the current entry:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>org-set-tags</span> <span style=color:#666>&#39;</span>(<span style=color:#4070a0>&#34;hello&#34;</span>))  <span style=color:#007020>:hello:</span>
</span></span></code></pre></div></li></ul><h4 id=properties-related>Properties related</h4><p>Properties in org-mode is as follows, where a property called &ldquo;prop&rdquo; has a &ldquo;value&rdquo;. It is handy to store some meta data using properties.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-org data-lang=org><span style=display:flex><span><span style=color:navy;font-weight:700>*</span><span style=font-weight:700> headline</span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>:PROPERTIES:
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#60a0b0;background-color:#fff0f0>:prop: value
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;background-color:#fff0f0></span><span style=color:#60a0b0;font-style:italic>:END:</span>
</span></span></code></pre></div><ul><li><p>Get properties</p><p>Get properties of the current entry:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>org-entry-properties</span>)
</span></span></code></pre></div></li></ul><ul><li><p>Set property</p><p>To set a property on the current entry:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>org-set-property</span> <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#4070a0>&#34;tom&#34;</span>)
</span></span></code></pre></div></li></ul><h3 id=file-and-path>file and path</h3><h4 id=get-the-path-of-the-current-file>Get the path of the current file</h4><p>The <code>buffer-file-name</code> is a buffer builtin variable holding the file name of the current buffer.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>file-truename</span> <span style=color:#06287e>buffer-file-name</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>/tmp/emacs-essentials.org
</span></span></code></pre></div><h4 id=get-path-without-suffix>Get path without suffix</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>file-name-sans-extension</span> <span style=color:#4070a0>&#34;/tmp/a.org&#34;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>/tmp/a
</span></span></code></pre></div><h4 id=write-to-file>Write to file</h4><p>Overwrite the content:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>with-temp-file</span> <span style=color:#4070a0>&#34;/tmp/1.org&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#06287e>insert</span> <span style=color:#4070a0>&#34;hello world&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#06287e>message</span> <span style=color:#4070a0>&#34;file content: %s&#34;</span> (<span style=color:#06287e>buffer-string</span>))
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>file content: hello world
</span></span></code></pre></div><h3 id=execute-shell-command>execute shell command</h3><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#bb60d5>shell-command</span> <span style=color:#4070a0>&#34;echo hello&#34;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>0
</span></span></code></pre></div><h3 id=condition-case-try-catch-in-elisp>condition-case: try-catch in elisp</h3><p>Like the try-catch in Python, where a try-catch can launch some unsafe function and catch the error.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>condition-case</span> <span style=color:#bb60d5>err</span>
</span></span><span style=display:flex><span>    (<span style=color:#007020>progn</span>
</span></span><span style=display:flex><span>      (<span style=color:#06287e>message</span> <span style=color:#4070a0>&#34;No error&#34;</span>))
</span></span><span style=display:flex><span>  (<span style=color:#007020>error</span> <span style=color:#4070a0>&#34;some error&#34;</span>)
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>No error
</span></span></code></pre></div><h2 id=modern-libraries>Modern libraries</h2><h3 id=ht-dot-el-for-hashtables>ht.el for hashtables</h3><p>Reference <a href=https://github.com/Wilfred/ht.el>ht.el</a> for more details.</p><h4 id=creating-a-hash-table>creating a hash table</h4><p>Create an empty hash table</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>let*</span> ((<span style=color:#bb60d5>the-dic</span> (<span style=color:#bb60d5>ht-create</span>)))
</span></span><span style=display:flex><span>  <span style=color:#bb60d5>the-dic</span>
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#s(hash-table size 65 test equal rehash-size 1.5 rehash-threshold 0.8125 data ())
</span></span></code></pre></div><p>Create a hash table with initial records</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>let*</span> ((<span style=color:#bb60d5>the-dic</span> (<span style=color:#bb60d5>ht</span>
</span></span><span style=display:flex><span>                 (<span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#4070a0>&#34;Tom&#34;</span>)
</span></span><span style=display:flex><span>                 (<span style=color:#4070a0>&#34;sex&#34;</span> <span style=color:#517918>&#39;male</span>))))
</span></span><span style=display:flex><span>  <span style=color:#bb60d5>the-dic</span>
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#s(hash-table size 65 test equal rehash-size 1.5 rehash-threshold 0.8125 data (&#34;name&#34; &#34;Tom&#34; &#34;sex&#34; male))
</span></span></code></pre></div><h4 id=accessing-the-hash-table>accessing the hash table</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>let*</span> ((<span style=color:#bb60d5>the-dic</span> (<span style=color:#bb60d5>ht</span> (<span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#4070a0>&#34;Tom&#34;</span>) (<span style=color:#4070a0>&#34;sex&#34;</span> <span style=color:#517918>&#39;male</span>))))
</span></span><span style=display:flex><span>  <span style=color:#60a0b0;font-style:italic>;; get a record</span>
</span></span><span style=display:flex><span>  <span style=color:#60a0b0;font-style:italic>;; returns &#34;Tom&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#bb60d5>ht-get</span> <span style=color:#bb60d5>the-dic</span> <span style=color:#4070a0>&#34;name&#34;</span>)
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Tom
</span></span></code></pre></div><h4 id=iterating-over-the-hash-table>Iterating over the hash table</h4><p>Readonly mapping:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>let*</span> ((<span style=color:#bb60d5>the-dic</span> (<span style=color:#bb60d5>ht</span> (<span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#4070a0>&#34;Tom&#34;</span>) (<span style=color:#4070a0>&#34;sex&#34;</span> <span style=color:#517918>&#39;male</span>) (<span style=color:#4070a0>&#34;age&#34;</span> <span style=color:#40a070>18</span>))))
</span></span><span style=display:flex><span>  (<span style=color:#bb60d5>ht-map</span> (<span style=color:#007020>lambda</span> (<span style=color:#bb60d5>key</span> <span style=color:#bb60d5>value</span>) (<span style=color:#06287e>message</span> <span style=color:#4070a0>&#34;%S: %S&#34;</span> <span style=color:#bb60d5>key</span> <span style=color:#bb60d5>value</span>)) <span style=color:#bb60d5>the-dic</span>)
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>&ldquo;age&rdquo;: 18</td><td>&ldquo;sex&rdquo;: male</td><td>&ldquo;name&rdquo;: &ldquo;Tom&rdquo;</td></tr></tbody></table><p>Mutable mapping:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#007020>let*</span> ((<span style=color:#bb60d5>the-dic</span> (<span style=color:#bb60d5>ht</span> (<span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#4070a0>&#34;Tom&#34;</span>) (<span style=color:#4070a0>&#34;sex&#34;</span> <span style=color:#517918>&#39;male</span>) (<span style=color:#4070a0>&#34;age&#34;</span> <span style=color:#40a070>18</span>))))
</span></span><span style=display:flex><span>  (<span style=color:#bb60d5>ht-map</span> (<span style=color:#007020>lambda</span> (<span style=color:#bb60d5>key</span> <span style=color:#bb60d5>value</span>)
</span></span><span style=display:flex><span>            <span style=color:#60a0b0;font-style:italic>;; modify the value if is string</span>
</span></span><span style=display:flex><span>            (<span style=color:#007020>setf</span> <span style=color:#bb60d5>value</span> (<span style=color:#007020>if</span> (<span style=color:#06287e>stringp</span> <span style=color:#bb60d5>value</span>)
</span></span><span style=display:flex><span>                            (<span style=color:#06287e>concat</span> <span style=color:#4070a0>&#34;modified &#34;</span> <span style=color:#bb60d5>value</span>)
</span></span><span style=display:flex><span>                          <span style=color:#bb60d5>value</span>))) <span style=color:#bb60d5>the-dic</span>))
</span></span></code></pre></div><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>18</td><td>male</td><td>modified Tom</td></tr></tbody></table><h2 id=debug-and-development-in-elisp>Debug and development in Elisp</h2><p>One handly tool is <code>toggle-debug-on-error</code>, it will print the error stack.</p><script src=https://utteranc.es/client.js repo=superjomn/superjomn.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script></article></main><p class="footer text-center">Copyright (c) 2024 Chunwei Yan</p></main></div><script src=/js/feather.min.js></script><script>feather.replace()</script></body></html>